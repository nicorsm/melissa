// Wire
// Copyright (C) 2018 Wire Swiss GmbH
//
// This program is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// This program is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with this program. If not, see http://www.gnu.org/licenses/.

use codec::*;
use std::ops::Range;

pub fn log2(n: usize) -> usize {
    let mut r = 0;
    let mut m = n;
    while m > 1 {
        m >>= 1;
        r += 1;
    }
    r
}

pub fn pow2(n: usize) -> usize {
    match n {
        0 => 1,
        _ => 2 << (n - 1),
    }
}

pub fn level(n: usize) -> usize {
    if (n & 0x01) == 0 {
        return 0;
    }
    let mut k = 0;
    while ((n >> k) & 0x01) == 1 {
        k += 1;
    }
    k
}

pub fn node_width(n: usize) -> usize {
    2 * (n - 1) + 1
}

pub fn assert_in_range(x: usize, n: usize) {
    if x > node_width(n) {
        panic!("node index out of range ({} > {})", x, n);
    }
}

pub fn root(n: usize) -> usize {
    let w = node_width(n);
    (1 << log2(w)) - 1
}

pub fn left(x: usize) -> usize {
    if level(x) == 0 {
        return x;
    }
    x ^ (0x01 << (level(x) - 1))
}

pub fn right(x: usize, n: usize) -> usize {
    assert_in_range(x, n);
    if level(x) == 0 {
        return x;
    }
    let mut r = x ^ (0x03 << (level(x) - 1));
    while r >= node_width(n) {
        r = left(r);
    }
    r
}

pub fn parent_step(x: usize) -> usize {
    let k = level(x);
    (x | (1 << k)) & !(1 << (k + 1))
}

pub fn parent(x: usize, n: usize) -> usize {
    if x == root(n) {
        return x;
    }

    let l0 = level(x);
    let l1 = level(x) + 1;
    let distance = pow2(l1);
    let left_offset = pow2(l0) - 1;

    let parity = (x - left_offset) / distance;
    let p = if parity & 0x01 == 1 {
        x - (distance / 2)
    } else {
        x + (distance / 2)
    };

    if p >= node_width(n) {
        parent(p, n)
    } else {
        p
    }
}

pub fn sibling(x: usize, n: usize) -> usize {
    assert_in_range(x, n);

    let p = parent(x, n);
    if x < p {
        return right(p, n);
    } else if x > p {
        return left(p);
    }
    // root's sibling is itself
    p
}

// Ordered from leaf to root
// Includes leaf, but not root
pub fn dirpath(x: usize, n: usize) -> Vec<usize> {
    assert_in_range(x, n);
    if x == root(n) {
        return Vec::new();
    }
    let mut dirpath = vec![x];
    let mut node_parent = parent(x, n);
    let root = root(n);
    while node_parent != root {
        dirpath.push(node_parent);
        node_parent = parent(node_parent, n);
    }
    dirpath
}

// Ordered from leaf to root
pub fn copath(x: usize, n: usize) -> Vec<usize> {
    dirpath(x, n).iter().map(|&x| sibling(x, n)).collect()
}

pub fn leaves(n: usize) -> Vec<usize> {
    Range { start: 0, end: n }.map(|x| 2 * x).collect()
}

#[derive(Clone, Copy)]
pub enum FunctionType {
    OneArg(fn(usize) -> usize),
    TwoArgs(fn(usize, usize) -> usize),
    TwoArgsPath(fn(usize, usize) -> Vec<usize>),
}

pub enum ReturnType {
    Primitive(Vec<usize>),
    Vector(Vec<Vec<usize>>),
}

pub fn gen_vector(range_start: usize, range_end: usize, size: usize, ft: FunctionType) -> Vec<u8> {
    let range = Range {
        start: range_start,
        end: range_end,
    };
    let mut test_vector: Vec<u32> = Vec::new();
    let mut test_vector_2d: Vec<Vec<u32>> = Vec::new();
    for i in range {
        match ft {
            FunctionType::OneArg(f) => {
                test_vector.push(f(i) as u32);
            }
            FunctionType::TwoArgs(f) => {
                test_vector.push(f(i, size) as u32);
            }
            FunctionType::TwoArgsPath(f) => {
                let sub_vector_usize = f(i, size);
                let mut sub_vector_u32 = Vec::new();
                sub_vector_usize
                    .iter()
                    .for_each(|&x| sub_vector_u32.push(x as u32));
                test_vector_2d.push(sub_vector_u32);
            }
        }
    }

    let mut buffer = Vec::new();

    match ft {
        FunctionType::OneArg(_) => {
            encode_vec_u32(&mut buffer, &test_vector);
        }
        FunctionType::TwoArgs(_) => {
            encode_vec_u32(&mut buffer, &test_vector);
        }
        FunctionType::TwoArgsPath(_) => {
            for e in test_vector_2d.iter_mut() {
                (e.len() as u32).encode(&mut buffer);
                encode_vec_u32(&mut buffer, e);
            }
        }
    }
    buffer
}

pub fn read_vector(rt: &ReturnType, buffer: &[u8]) -> ReturnType {
    let mut vector = Vec::new();
    let mut vector2d = Vec::new();
    let mut cursor = Cursor::new(buffer);

    match *rt {
        ReturnType::Primitive(_) => {
            let vector_usize: Vec<u32> = decode_vec_u32(&mut cursor).unwrap();
            vector_usize.iter().for_each(|&x| vector.push(x as usize));
            ReturnType::Primitive(vector)
        }
        ReturnType::Vector(_) => {
            let size = u32::decode(&mut cursor).unwrap();
            //let size = cursor.take(1).unwrap()[0];
            for _ in 0..size {
                let mut sub_vector = Vec::new();
                let sub_vector_usize: Vec<u32> = decode_vec_u32(&mut cursor).unwrap();
                sub_vector_usize
                    .iter()
                    .for_each(|&x| sub_vector.push(x as usize));
                vector2d.push(sub_vector);
            }
            ReturnType::Vector(vector2d)
        }
    }
}

#[test]
fn print_test_vectors() {
    use utils::*;

    let size = 255;
    println!(
        "Test vector for root() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(1, size, size, FunctionType::OneArg(root),))
    );
    println!(
        "Test vector for level() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(0, size - 1, size, FunctionType::OneArg(level),))
    );
    println!(
        "Test vector for node_width() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(1, size, size, FunctionType::OneArg(node_width),))
    );
    println!(
        "Test vector for left() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(0, size - 1, size, FunctionType::OneArg(left),))
    );
    println!(
        "Test vector for parent_step() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(
            0,
            size - 1,
            size,
            FunctionType::OneArg(parent_step),
        ))
    );
    println!(
        "Test vector for right() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(0, size - 1, size, FunctionType::TwoArgs(right),))
    );
    println!(
        "Test vector for parent() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(
            0,
            size - 1,
            size,
            FunctionType::TwoArgs(parent),
        ))
    );
    println!(
        "Test vector for sibling() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(
            0,
            size - 1,
            size,
            FunctionType::TwoArgs(sibling),
        ))
    );
    println!(
        "Test vector for dirpath() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(
            0,
            size - 1,
            size,
            FunctionType::TwoArgsPath(dirpath),
        ))
    );
    println!(
        "Test vector for copath() with size {}:\n{}",
        size,
        bytes_to_hex(&gen_vector(
            0,
            size - 1,
            size,
            FunctionType::TwoArgsPath(copath),
        ))
    );
}

#[test]
fn compare_test_vectors() {
    use utils::*;

    fn test_vector(
        test_vector_hex: &str,
        range_start: usize,
        size: usize,
        ft: FunctionType,
    ) -> bool {
        let test_vector = hex_to_bytes(test_vector_hex);
        let gen_vector = gen_vector(range_start, size + range_start - 1, size, ft);
        assert_eq!(gen_vector, test_vector);
        gen_vector == test_vector
    }

    let size = 255;
    let root_hex = "000003F800000000000000010000000300000003000000070000000700000007000000070000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000001F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000003F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF000000FF";
    assert!(test_vector(root_hex, 1, size, FunctionType::OneArg(root)));
    let level_hex = "000003F80000000000000001000000000000000200000000000000010000000000000003000000000000000100000000000000020000000000000001000000000000000400000000000000010000000000000002000000000000000100000000000000030000000000000001000000000000000200000000000000010000000000000005000000000000000100000000000000020000000000000001000000000000000300000000000000010000000000000002000000000000000100000000000000040000000000000001000000000000000200000000000000010000000000000003000000000000000100000000000000020000000000000001000000000000000600000000000000010000000000000002000000000000000100000000000000030000000000000001000000000000000200000000000000010000000000000004000000000000000100000000000000020000000000000001000000000000000300000000000000010000000000000002000000000000000100000000000000050000000000000001000000000000000200000000000000010000000000000003000000000000000100000000000000020000000000000001000000000000000400000000000000010000000000000002000000000000000100000000000000030000000000000001000000000000000200000000000000010000000000000007000000000000000100000000000000020000000000000001000000000000000300000000000000010000000000000002000000000000000100000000000000040000000000000001000000000000000200000000000000010000000000000003000000000000000100000000000000020000000000000001000000000000000500000000000000010000000000000002000000000000000100000000000000030000000000000001000000000000000200000000000000010000000000000004000000000000000100000000000000020000000000000001000000000000000300000000000000010000000000000002000000000000000100000000000000060000000000000001000000000000000200000000000000010000000000000003000000000000000100000000000000020000000000000001000000000000000400000000000000010000000000000002000000000000000100000000000000030000000000000001000000000000000200000000000000010000000000000005000000000000000100000000000000020000000000000001000000000000000300000000000000010000000000000002000000000000000100000000000000040000000000000001000000000000000200000000000000010000000000000003000000000000000100000000000000020000000000000001";
    assert!(test_vector(level_hex, 0, size, FunctionType::OneArg(level)));
    let node_width_hex = "000003F800000001000000030000000500000007000000090000000B0000000D0000000F00000011000000130000001500000017000000190000001B0000001D0000001F00000021000000230000002500000027000000290000002B0000002D0000002F00000031000000330000003500000037000000390000003B0000003D0000003F00000041000000430000004500000047000000490000004B0000004D0000004F00000051000000530000005500000057000000590000005B0000005D0000005F00000061000000630000006500000067000000690000006B0000006D0000006F00000071000000730000007500000077000000790000007B0000007D0000007F00000081000000830000008500000087000000890000008B0000008D0000008F00000091000000930000009500000097000000990000009B0000009D0000009F000000A1000000A3000000A5000000A7000000A9000000AB000000AD000000AF000000B1000000B3000000B5000000B7000000B9000000BB000000BD000000BF000000C1000000C3000000C5000000C7000000C9000000CB000000CD000000CF000000D1000000D3000000D5000000D7000000D9000000DB000000DD000000DF000000E1000000E3000000E5000000E7000000E9000000EB000000ED000000EF000000F1000000F3000000F5000000F7000000F9000000FB000000FD000000FF00000101000001030000010500000107000001090000010B0000010D0000010F00000111000001130000011500000117000001190000011B0000011D0000011F00000121000001230000012500000127000001290000012B0000012D0000012F00000131000001330000013500000137000001390000013B0000013D0000013F00000141000001430000014500000147000001490000014B0000014D0000014F00000151000001530000015500000157000001590000015B0000015D0000015F00000161000001630000016500000167000001690000016B0000016D0000016F00000171000001730000017500000177000001790000017B0000017D0000017F00000181000001830000018500000187000001890000018B0000018D0000018F00000191000001930000019500000197000001990000019B0000019D0000019F000001A1000001A3000001A5000001A7000001A9000001AB000001AD000001AF000001B1000001B3000001B5000001B7000001B9000001BB000001BD000001BF000001C1000001C3000001C5000001C7000001C9000001CB000001CD000001CF000001D1000001D3000001D5000001D7000001D9000001DB000001DD000001DF000001E1000001E3000001E5000001E7000001E9000001EB000001ED000001EF000001F1000001F3000001F5000001F7000001F9000001FB";
    assert!(test_vector(
        node_width_hex,
        1,
        size,
        FunctionType::OneArg(node_width)
    ));
    let left_hex = "000003F8000000000000000000000002000000010000000400000004000000060000000300000008000000080000000A000000090000000C0000000C0000000E00000007000000100000001000000012000000110000001400000014000000160000001300000018000000180000001A000000190000001C0000001C0000001E0000000F000000200000002000000022000000210000002400000024000000260000002300000028000000280000002A000000290000002C0000002C0000002E00000027000000300000003000000032000000310000003400000034000000360000003300000038000000380000003A000000390000003C0000003C0000003E0000001F000000400000004000000042000000410000004400000044000000460000004300000048000000480000004A000000490000004C0000004C0000004E00000047000000500000005000000052000000510000005400000054000000560000005300000058000000580000005A000000590000005C0000005C0000005E0000004F000000600000006000000062000000610000006400000064000000660000006300000068000000680000006A000000690000006C0000006C0000006E00000067000000700000007000000072000000710000007400000074000000760000007300000078000000780000007A000000790000007C0000007C0000007E0000003F000000800000008000000082000000810000008400000084000000860000008300000088000000880000008A000000890000008C0000008C0000008E00000087000000900000009000000092000000910000009400000094000000960000009300000098000000980000009A000000990000009C0000009C0000009E0000008F000000A0000000A0000000A2000000A1000000A4000000A4000000A6000000A3000000A8000000A8000000AA000000A9000000AC000000AC000000AE000000A7000000B0000000B0000000B2000000B1000000B4000000B4000000B6000000B3000000B8000000B8000000BA000000B9000000BC000000BC000000BE0000009F000000C0000000C0000000C2000000C1000000C4000000C4000000C6000000C3000000C8000000C8000000CA000000C9000000CC000000CC000000CE000000C7000000D0000000D0000000D2000000D1000000D4000000D4000000D6000000D3000000D8000000D8000000DA000000D9000000DC000000DC000000DE000000CF000000E0000000E0000000E2000000E1000000E4000000E4000000E6000000E3000000E8000000E8000000EA000000E9000000EC000000EC000000EE000000E7000000F0000000F0000000F2000000F1000000F4000000F4000000F6000000F3000000F8000000F8000000FA000000F9000000FC000000FC";
    assert!(test_vector(left_hex, 0, size, FunctionType::OneArg(left)));
    let parent_step_hex = "000003F8000000010000000300000001000000070000000500000003000000050000000F000000090000000B00000009000000070000000D0000000B0000000D0000001F000000110000001300000011000000170000001500000013000000150000000F000000190000001B00000019000000170000001D0000001B0000001D0000003F000000210000002300000021000000270000002500000023000000250000002F000000290000002B00000029000000270000002D0000002B0000002D0000001F000000310000003300000031000000370000003500000033000000350000002F000000390000003B00000039000000370000003D0000003B0000003D0000007F000000410000004300000041000000470000004500000043000000450000004F000000490000004B00000049000000470000004D0000004B0000004D0000005F000000510000005300000051000000570000005500000053000000550000004F000000590000005B00000059000000570000005D0000005B0000005D0000003F000000610000006300000061000000670000006500000063000000650000006F000000690000006B00000069000000670000006D0000006B0000006D0000005F000000710000007300000071000000770000007500000073000000750000006F000000790000007B00000079000000770000007D0000007B0000007D000000FF000000810000008300000081000000870000008500000083000000850000008F000000890000008B00000089000000870000008D0000008B0000008D0000009F000000910000009300000091000000970000009500000093000000950000008F000000990000009B00000099000000970000009D0000009B0000009D000000BF000000A1000000A3000000A1000000A7000000A5000000A3000000A5000000AF000000A9000000AB000000A9000000A7000000AD000000AB000000AD0000009F000000B1000000B3000000B1000000B7000000B5000000B3000000B5000000AF000000B9000000BB000000B9000000B7000000BD000000BB000000BD0000007F000000C1000000C3000000C1000000C7000000C5000000C3000000C5000000CF000000C9000000CB000000C9000000C7000000CD000000CB000000CD000000DF000000D1000000D3000000D1000000D7000000D5000000D3000000D5000000CF000000D9000000DB000000D9000000D7000000DD000000DB000000DD000000BF000000E1000000E3000000E1000000E7000000E5000000E3000000E5000000EF000000E9000000EB000000E9000000E7000000ED000000EB000000ED000000DF000000F1000000F3000000F1000000F7000000F5000000F3000000F5000000EF000000F9000000FB000000F9000000F7000000FD000000FB";
    assert!(test_vector(
        parent_step_hex,
        0,
        size,
        FunctionType::OneArg(parent_step)
    ));
    let right_hex = "000003F8000000000000000200000002000000050000000400000006000000060000000B000000080000000A0000000A0000000D0000000C0000000E0000000E00000017000000100000001200000012000000150000001400000016000000160000001B000000180000001A0000001A0000001D0000001C0000001E0000001E0000002F000000200000002200000022000000250000002400000026000000260000002B000000280000002A0000002A0000002D0000002C0000002E0000002E00000037000000300000003200000032000000350000003400000036000000360000003B000000380000003A0000003A0000003D0000003C0000003E0000003E0000005F000000400000004200000042000000450000004400000046000000460000004B000000480000004A0000004A0000004D0000004C0000004E0000004E00000057000000500000005200000052000000550000005400000056000000560000005B000000580000005A0000005A0000005D0000005C0000005E0000005E0000006F000000600000006200000062000000650000006400000066000000660000006B000000680000006A0000006A0000006D0000006C0000006E0000006E00000077000000700000007200000072000000750000007400000076000000760000007B000000780000007A0000007A0000007D0000007C0000007E0000007E000000BF000000800000008200000082000000850000008400000086000000860000008B000000880000008A0000008A0000008D0000008C0000008E0000008E00000097000000900000009200000092000000950000009400000096000000960000009B000000980000009A0000009A0000009D0000009C0000009E0000009E000000AF000000A0000000A2000000A2000000A5000000A4000000A6000000A6000000AB000000A8000000AA000000AA000000AD000000AC000000AE000000AE000000B7000000B0000000B2000000B2000000B5000000B4000000B6000000B6000000BB000000B8000000BA000000BA000000BD000000BC000000BE000000BE000000DF000000C0000000C2000000C2000000C5000000C4000000C6000000C6000000CB000000C8000000CA000000CA000000CD000000CC000000CE000000CE000000D7000000D0000000D2000000D2000000D5000000D4000000D6000000D6000000DB000000D8000000DA000000DA000000DD000000DC000000DE000000DE000000EF000000E0000000E2000000E2000000E5000000E4000000E6000000E6000000EB000000E8000000EA000000EA000000ED000000EC000000EE000000EE000000F7000000F0000000F2000000F2000000F5000000F4000000F6000000F6000000FB000000F8000000FA000000FA000000FD000000FC000000FE";
    assert!(test_vector(
        right_hex,
        0,
        size,
        FunctionType::TwoArgs(right)
    ));
    let parent_hex = "000003F8000000010000000300000001000000070000000500000003000000050000000F000000090000000B00000009000000070000000D0000000B0000000D0000001F000000110000001300000011000000170000001500000013000000150000000F000000190000001B00000019000000170000001D0000001B0000001D0000003F000000210000002300000021000000270000002500000023000000250000002F000000290000002B00000029000000270000002D0000002B0000002D0000001F000000310000003300000031000000370000003500000033000000350000002F000000390000003B00000039000000370000003D0000003B0000003D0000007F000000410000004300000041000000470000004500000043000000450000004F000000490000004B00000049000000470000004D0000004B0000004D0000005F000000510000005300000051000000570000005500000053000000550000004F000000590000005B00000059000000570000005D0000005B0000005D0000003F000000610000006300000061000000670000006500000063000000650000006F000000690000006B00000069000000670000006D0000006B0000006D0000005F000000710000007300000071000000770000007500000073000000750000006F000000790000007B00000079000000770000007D0000007B0000007D000000FF000000810000008300000081000000870000008500000083000000850000008F000000890000008B00000089000000870000008D0000008B0000008D0000009F000000910000009300000091000000970000009500000093000000950000008F000000990000009B00000099000000970000009D0000009B0000009D000000BF000000A1000000A3000000A1000000A7000000A5000000A3000000A5000000AF000000A9000000AB000000A9000000A7000000AD000000AB000000AD0000009F000000B1000000B3000000B1000000B7000000B5000000B3000000B5000000AF000000B9000000BB000000B9000000B7000000BD000000BB000000BD0000007F000000C1000000C3000000C1000000C7000000C5000000C3000000C5000000CF000000C9000000CB000000C9000000C7000000CD000000CB000000CD000000DF000000D1000000D3000000D1000000D7000000D5000000D3000000D5000000CF000000D9000000DB000000D9000000D7000000DD000000DB000000DD000000BF000000E1000000E3000000E1000000E7000000E5000000E3000000E5000000EF000000E9000000EB000000E9000000E7000000ED000000EB000000ED000000DF000000F1000000F3000000F1000000F7000000F5000000F3000000F5000000EF000000F9000000FB000000F9000000F7000000FD000000FB";
    assert!(test_vector(
        parent_hex,
        0,
        size,
        FunctionType::TwoArgs(parent)
    ));
    let sibling_hex = "000003F80000000200000005000000000000000B000000060000000100000004000000170000000A0000000D00000008000000030000000E000000090000000C0000002F0000001200000015000000100000001B000000160000001100000014000000070000001A0000001D00000018000000130000001E000000190000001C0000005F0000002200000025000000200000002B000000260000002100000024000000370000002A0000002D00000028000000230000002E000000290000002C0000000F0000003200000035000000300000003B000000360000003100000034000000270000003A0000003D00000038000000330000003E000000390000003C000000BF0000004200000045000000400000004B000000460000004100000044000000570000004A0000004D00000048000000430000004E000000490000004C0000006F0000005200000055000000500000005B000000560000005100000054000000470000005A0000005D00000058000000530000005E000000590000005C0000001F0000006200000065000000600000006B000000660000006100000064000000770000006A0000006D00000068000000630000006E000000690000006C0000004F0000007200000075000000700000007B000000760000007100000074000000670000007A0000007D00000078000000730000007E000000790000007C0000017F0000008200000085000000800000008B000000860000008100000084000000970000008A0000008D00000088000000830000008E000000890000008C000000AF0000009200000095000000900000009B000000960000009100000094000000870000009A0000009D00000098000000930000009E000000990000009C000000DF000000A2000000A5000000A0000000AB000000A6000000A1000000A4000000B7000000AA000000AD000000A8000000A3000000AE000000A9000000AC0000008F000000B2000000B5000000B0000000BB000000B6000000B1000000B4000000A7000000BA000000BD000000B8000000B3000000BE000000B9000000BC0000003F000000C2000000C5000000C0000000CB000000C6000000C1000000C4000000D7000000CA000000CD000000C8000000C3000000CE000000C9000000CC000000EF000000D2000000D5000000D0000000DB000000D6000000D1000000D4000000C7000000DA000000DD000000D8000000D3000000DE000000D9000000DC0000009F000000E2000000E5000000E0000000EB000000E6000000E1000000E4000000F7000000EA000000ED000000E8000000E3000000EE000000E9000000EC000000CF000000F2000000F5000000F0000000FB000000F6000000F1000000F4000000E7000000FA000000FD000000F8000000F3000000FE000000F9";
    assert!(test_vector(
        sibling_hex,
        0,
        size,
        FunctionType::TwoArgs(sibling)
    ));
    let dirpath_hex = "0000000800000020000000000000000100000003000000070000000F0000001F0000003F0000007F000000070000001C0000000100000003000000070000000F0000001F0000003F0000007F0000000800000020000000020000000100000003000000070000000F0000001F0000003F0000007F000000060000001800000003000000070000000F0000001F0000003F0000007F0000000800000020000000040000000500000003000000070000000F0000001F0000003F0000007F000000070000001C0000000500000003000000070000000F0000001F0000003F0000007F0000000800000020000000060000000500000003000000070000000F0000001F0000003F0000007F0000000500000014000000070000000F0000001F0000003F0000007F000000080000002000000008000000090000000B000000070000000F0000001F0000003F0000007F000000070000001C000000090000000B000000070000000F0000001F0000003F0000007F00000008000000200000000A000000090000000B000000070000000F0000001F0000003F0000007F00000006000000180000000B000000070000000F0000001F0000003F0000007F00000008000000200000000C0000000D0000000B000000070000000F0000001F0000003F0000007F000000070000001C0000000D0000000B000000070000000F0000001F0000003F0000007F00000008000000200000000E0000000D0000000B000000070000000F0000001F0000003F0000007F00000004000000100000000F0000001F0000003F0000007F0000000800000020000000100000001100000013000000170000000F0000001F0000003F0000007F000000070000001C0000001100000013000000170000000F0000001F0000003F0000007F0000000800000020000000120000001100000013000000170000000F0000001F0000003F0000007F000000060000001800000013000000170000000F0000001F0000003F0000007F0000000800000020000000140000001500000013000000170000000F0000001F0000003F0000007F000000070000001C0000001500000013000000170000000F0000001F0000003F0000007F0000000800000020000000160000001500000013000000170000000F0000001F0000003F0000007F0000000500000014000000170000000F0000001F0000003F0000007F000000080000002000000018000000190000001B000000170000000F0000001F0000003F0000007F000000070000001C000000190000001B000000170000000F0000001F0000003F0000007F00000008000000200000001A000000190000001B000000170000000F0000001F0000003F0000007F00000006000000180000001B000000170000000F0000001F0000003F0000007F00000008000000200000001C0000001D0000001B000000170000000F0000001F0000003F0000007F000000070000001C0000001D0000001B000000170000000F0000001F0000003F0000007F00000008000000200000001E0000001D0000001B000000170000000F0000001F0000003F0000007F000000030000000C0000001F0000003F0000007F0000000800000020000000200000002100000023000000270000002F0000001F0000003F0000007F000000070000001C0000002100000023000000270000002F0000001F0000003F0000007F0000000800000020000000220000002100000023000000270000002F0000001F0000003F0000007F000000060000001800000023000000270000002F0000001F0000003F0000007F0000000800000020000000240000002500000023000000270000002F0000001F0000003F0000007F000000070000001C0000002500000023000000270000002F0000001F0000003F0000007F0000000800000020000000260000002500000023000000270000002F0000001F0000003F0000007F0000000500000014000000270000002F0000001F0000003F0000007F000000080000002000000028000000290000002B000000270000002F0000001F0000003F0000007F000000070000001C000000290000002B000000270000002F0000001F0000003F0000007F00000008000000200000002A000000290000002B000000270000002F0000001F0000003F0000007F00000006000000180000002B000000270000002F0000001F0000003F0000007F00000008000000200000002C0000002D0000002B000000270000002F0000001F0000003F0000007F000000070000001C0000002D0000002B000000270000002F0000001F0000003F0000007F00000008000000200000002E0000002D0000002B000000270000002F0000001F0000003F0000007F00000004000000100000002F0000001F0000003F0000007F0000000800000020000000300000003100000033000000370000002F0000001F0000003F0000007F000000070000001C0000003100000033000000370000002F0000001F0000003F0000007F0000000800000020000000320000003100000033000000370000002F0000001F0000003F0000007F000000060000001800000033000000370000002F0000001F0000003F0000007F0000000800000020000000340000003500000033000000370000002F0000001F0000003F0000007F000000070000001C0000003500000033000000370000002F0000001F0000003F0000007F0000000800000020000000360000003500000033000000370000002F0000001F0000003F0000007F0000000500000014000000370000002F0000001F0000003F0000007F000000080000002000000038000000390000003B000000370000002F0000001F0000003F0000007F000000070000001C000000390000003B000000370000002F0000001F0000003F0000007F00000008000000200000003A000000390000003B000000370000002F0000001F0000003F0000007F00000006000000180000003B000000370000002F0000001F0000003F0000007F00000008000000200000003C0000003D0000003B000000370000002F0000001F0000003F0000007F000000070000001C0000003D0000003B000000370000002F0000001F0000003F0000007F00000008000000200000003E0000003D0000003B000000370000002F0000001F0000003F0000007F00000002000000080000003F0000007F0000000800000020000000400000004100000043000000470000004F0000005F0000003F0000007F000000070000001C0000004100000043000000470000004F0000005F0000003F0000007F0000000800000020000000420000004100000043000000470000004F0000005F0000003F0000007F000000060000001800000043000000470000004F0000005F0000003F0000007F0000000800000020000000440000004500000043000000470000004F0000005F0000003F0000007F000000070000001C0000004500000043000000470000004F0000005F0000003F0000007F0000000800000020000000460000004500000043000000470000004F0000005F0000003F0000007F0000000500000014000000470000004F0000005F0000003F0000007F000000080000002000000048000000490000004B000000470000004F0000005F0000003F0000007F000000070000001C000000490000004B000000470000004F0000005F0000003F0000007F00000008000000200000004A000000490000004B000000470000004F0000005F0000003F0000007F00000006000000180000004B000000470000004F0000005F0000003F0000007F00000008000000200000004C0000004D0000004B000000470000004F0000005F0000003F0000007F000000070000001C0000004D0000004B000000470000004F0000005F0000003F0000007F00000008000000200000004E0000004D0000004B000000470000004F0000005F0000003F0000007F00000004000000100000004F0000005F0000003F0000007F0000000800000020000000500000005100000053000000570000004F0000005F0000003F0000007F000000070000001C0000005100000053000000570000004F0000005F0000003F0000007F0000000800000020000000520000005100000053000000570000004F0000005F0000003F0000007F000000060000001800000053000000570000004F0000005F0000003F0000007F0000000800000020000000540000005500000053000000570000004F0000005F0000003F0000007F000000070000001C0000005500000053000000570000004F0000005F0000003F0000007F0000000800000020000000560000005500000053000000570000004F0000005F0000003F0000007F0000000500000014000000570000004F0000005F0000003F0000007F000000080000002000000058000000590000005B000000570000004F0000005F0000003F0000007F000000070000001C000000590000005B000000570000004F0000005F0000003F0000007F00000008000000200000005A000000590000005B000000570000004F0000005F0000003F0000007F00000006000000180000005B000000570000004F0000005F0000003F0000007F00000008000000200000005C0000005D0000005B000000570000004F0000005F0000003F0000007F000000070000001C0000005D0000005B000000570000004F0000005F0000003F0000007F00000008000000200000005E0000005D0000005B000000570000004F0000005F0000003F0000007F000000030000000C0000005F0000003F0000007F0000000800000020000000600000006100000063000000670000006F0000005F0000003F0000007F000000070000001C0000006100000063000000670000006F0000005F0000003F0000007F0000000800000020000000620000006100000063000000670000006F0000005F0000003F0000007F000000060000001800000063000000670000006F0000005F0000003F0000007F0000000800000020000000640000006500000063000000670000006F0000005F0000003F0000007F000000070000001C0000006500000063000000670000006F0000005F0000003F0000007F0000000800000020000000660000006500000063000000670000006F0000005F0000003F0000007F0000000500000014000000670000006F0000005F0000003F0000007F000000080000002000000068000000690000006B000000670000006F0000005F0000003F0000007F000000070000001C000000690000006B000000670000006F0000005F0000003F0000007F00000008000000200000006A000000690000006B000000670000006F0000005F0000003F0000007F00000006000000180000006B000000670000006F0000005F0000003F0000007F00000008000000200000006C0000006D0000006B000000670000006F0000005F0000003F0000007F000000070000001C0000006D0000006B000000670000006F0000005F0000003F0000007F00000008000000200000006E0000006D0000006B000000670000006F0000005F0000003F0000007F00000004000000100000006F0000005F0000003F0000007F0000000800000020000000700000007100000073000000770000006F0000005F0000003F0000007F000000070000001C0000007100000073000000770000006F0000005F0000003F0000007F0000000800000020000000720000007100000073000000770000006F0000005F0000003F0000007F000000060000001800000073000000770000006F0000005F0000003F0000007F0000000800000020000000740000007500000073000000770000006F0000005F0000003F0000007F000000070000001C0000007500000073000000770000006F0000005F0000003F0000007F0000000800000020000000760000007500000073000000770000006F0000005F0000003F0000007F0000000500000014000000770000006F0000005F0000003F0000007F000000080000002000000078000000790000007B000000770000006F0000005F0000003F0000007F000000070000001C000000790000007B000000770000006F0000005F0000003F0000007F00000008000000200000007A000000790000007B000000770000006F0000005F0000003F0000007F00000006000000180000007B000000770000006F0000005F0000003F0000007F00000008000000200000007C0000007D0000007B000000770000006F0000005F0000003F0000007F000000070000001C0000007D0000007B000000770000006F0000005F0000003F0000007F00000008000000200000007E0000007D0000007B000000770000006F0000005F0000003F0000007F00000001000000040000007F0000000800000020000000800000008100000083000000870000008F0000009F000000BF0000007F000000070000001C0000008100000083000000870000008F0000009F000000BF0000007F0000000800000020000000820000008100000083000000870000008F0000009F000000BF0000007F000000060000001800000083000000870000008F0000009F000000BF0000007F0000000800000020000000840000008500000083000000870000008F0000009F000000BF0000007F000000070000001C0000008500000083000000870000008F0000009F000000BF0000007F0000000800000020000000860000008500000083000000870000008F0000009F000000BF0000007F0000000500000014000000870000008F0000009F000000BF0000007F000000080000002000000088000000890000008B000000870000008F0000009F000000BF0000007F000000070000001C000000890000008B000000870000008F0000009F000000BF0000007F00000008000000200000008A000000890000008B000000870000008F0000009F000000BF0000007F00000006000000180000008B000000870000008F0000009F000000BF0000007F00000008000000200000008C0000008D0000008B000000870000008F0000009F000000BF0000007F000000070000001C0000008D0000008B000000870000008F0000009F000000BF0000007F00000008000000200000008E0000008D0000008B000000870000008F0000009F000000BF0000007F00000004000000100000008F0000009F000000BF0000007F0000000800000020000000900000009100000093000000970000008F0000009F000000BF0000007F000000070000001C0000009100000093000000970000008F0000009F000000BF0000007F0000000800000020000000920000009100000093000000970000008F0000009F000000BF0000007F000000060000001800000093000000970000008F0000009F000000BF0000007F0000000800000020000000940000009500000093000000970000008F0000009F000000BF0000007F000000070000001C0000009500000093000000970000008F0000009F000000BF0000007F0000000800000020000000960000009500000093000000970000008F0000009F000000BF0000007F0000000500000014000000970000008F0000009F000000BF0000007F000000080000002000000098000000990000009B000000970000008F0000009F000000BF0000007F000000070000001C000000990000009B000000970000008F0000009F000000BF0000007F00000008000000200000009A000000990000009B000000970000008F0000009F000000BF0000007F00000006000000180000009B000000970000008F0000009F000000BF0000007F00000008000000200000009C0000009D0000009B000000970000008F0000009F000000BF0000007F000000070000001C0000009D0000009B000000970000008F0000009F000000BF0000007F00000008000000200000009E0000009D0000009B000000970000008F0000009F000000BF0000007F000000030000000C0000009F000000BF0000007F0000000800000020000000A0000000A1000000A3000000A7000000AF0000009F000000BF0000007F000000070000001C000000A1000000A3000000A7000000AF0000009F000000BF0000007F0000000800000020000000A2000000A1000000A3000000A7000000AF0000009F000000BF0000007F0000000600000018000000A3000000A7000000AF0000009F000000BF0000007F0000000800000020000000A4000000A5000000A3000000A7000000AF0000009F000000BF0000007F000000070000001C000000A5000000A3000000A7000000AF0000009F000000BF0000007F0000000800000020000000A6000000A5000000A3000000A7000000AF0000009F000000BF0000007F0000000500000014000000A7000000AF0000009F000000BF0000007F0000000800000020000000A8000000A9000000AB000000A7000000AF0000009F000000BF0000007F000000070000001C000000A9000000AB000000A7000000AF0000009F000000BF0000007F0000000800000020000000AA000000A9000000AB000000A7000000AF0000009F000000BF0000007F0000000600000018000000AB000000A7000000AF0000009F000000BF0000007F0000000800000020000000AC000000AD000000AB000000A7000000AF0000009F000000BF0000007F000000070000001C000000AD000000AB000000A7000000AF0000009F000000BF0000007F0000000800000020000000AE000000AD000000AB000000A7000000AF0000009F000000BF0000007F0000000400000010000000AF0000009F000000BF0000007F0000000800000020000000B0000000B1000000B3000000B7000000AF0000009F000000BF0000007F000000070000001C000000B1000000B3000000B7000000AF0000009F000000BF0000007F0000000800000020000000B2000000B1000000B3000000B7000000AF0000009F000000BF0000007F0000000600000018000000B3000000B7000000AF0000009F000000BF0000007F0000000800000020000000B4000000B5000000B3000000B7000000AF0000009F000000BF0000007F000000070000001C000000B5000000B3000000B7000000AF0000009F000000BF0000007F0000000800000020000000B6000000B5000000B3000000B7000000AF0000009F000000BF0000007F0000000500000014000000B7000000AF0000009F000000BF0000007F0000000800000020000000B8000000B9000000BB000000B7000000AF0000009F000000BF0000007F000000070000001C000000B9000000BB000000B7000000AF0000009F000000BF0000007F0000000800000020000000BA000000B9000000BB000000B7000000AF0000009F000000BF0000007F0000000600000018000000BB000000B7000000AF0000009F000000BF0000007F0000000800000020000000BC000000BD000000BB000000B7000000AF0000009F000000BF0000007F000000070000001C000000BD000000BB000000B7000000AF0000009F000000BF0000007F0000000800000020000000BE000000BD000000BB000000B7000000AF0000009F000000BF0000007F0000000200000008000000BF0000007F0000000800000020000000C0000000C1000000C3000000C7000000CF000000DF000000BF0000007F000000070000001C000000C1000000C3000000C7000000CF000000DF000000BF0000007F0000000800000020000000C2000000C1000000C3000000C7000000CF000000DF000000BF0000007F0000000600000018000000C3000000C7000000CF000000DF000000BF0000007F0000000800000020000000C4000000C5000000C3000000C7000000CF000000DF000000BF0000007F000000070000001C000000C5000000C3000000C7000000CF000000DF000000BF0000007F0000000800000020000000C6000000C5000000C3000000C7000000CF000000DF000000BF0000007F0000000500000014000000C7000000CF000000DF000000BF0000007F0000000800000020000000C8000000C9000000CB000000C7000000CF000000DF000000BF0000007F000000070000001C000000C9000000CB000000C7000000CF000000DF000000BF0000007F0000000800000020000000CA000000C9000000CB000000C7000000CF000000DF000000BF0000007F0000000600000018000000CB000000C7000000CF000000DF000000BF0000007F0000000800000020000000CC000000CD000000CB000000C7000000CF000000DF000000BF0000007F000000070000001C000000CD000000CB000000C7000000CF000000DF000000BF0000007F0000000800000020000000CE000000CD000000CB000000C7000000CF000000DF000000BF0000007F0000000400000010000000CF000000DF000000BF0000007F0000000800000020000000D0000000D1000000D3000000D7000000CF000000DF000000BF0000007F000000070000001C000000D1000000D3000000D7000000CF000000DF000000BF0000007F0000000800000020000000D2000000D1000000D3000000D7000000CF000000DF000000BF0000007F0000000600000018000000D3000000D7000000CF000000DF000000BF0000007F0000000800000020000000D4000000D5000000D3000000D7000000CF000000DF000000BF0000007F000000070000001C000000D5000000D3000000D7000000CF000000DF000000BF0000007F0000000800000020000000D6000000D5000000D3000000D7000000CF000000DF000000BF0000007F0000000500000014000000D7000000CF000000DF000000BF0000007F0000000800000020000000D8000000D9000000DB000000D7000000CF000000DF000000BF0000007F000000070000001C000000D9000000DB000000D7000000CF000000DF000000BF0000007F0000000800000020000000DA000000D9000000DB000000D7000000CF000000DF000000BF0000007F0000000600000018000000DB000000D7000000CF000000DF000000BF0000007F0000000800000020000000DC000000DD000000DB000000D7000000CF000000DF000000BF0000007F000000070000001C000000DD000000DB000000D7000000CF000000DF000000BF0000007F0000000800000020000000DE000000DD000000DB000000D7000000CF000000DF000000BF0000007F000000030000000C000000DF000000BF0000007F0000000800000020000000E0000000E1000000E3000000E7000000EF000000DF000000BF0000007F000000070000001C000000E1000000E3000000E7000000EF000000DF000000BF0000007F0000000800000020000000E2000000E1000000E3000000E7000000EF000000DF000000BF0000007F0000000600000018000000E3000000E7000000EF000000DF000000BF0000007F0000000800000020000000E4000000E5000000E3000000E7000000EF000000DF000000BF0000007F000000070000001C000000E5000000E3000000E7000000EF000000DF000000BF0000007F0000000800000020000000E6000000E5000000E3000000E7000000EF000000DF000000BF0000007F0000000500000014000000E7000000EF000000DF000000BF0000007F0000000800000020000000E8000000E9000000EB000000E7000000EF000000DF000000BF0000007F000000070000001C000000E9000000EB000000E7000000EF000000DF000000BF0000007F0000000800000020000000EA000000E9000000EB000000E7000000EF000000DF000000BF0000007F0000000600000018000000EB000000E7000000EF000000DF000000BF0000007F0000000800000020000000EC000000ED000000EB000000E7000000EF000000DF000000BF0000007F000000070000001C000000ED000000EB000000E7000000EF000000DF000000BF0000007F0000000800000020000000EE000000ED000000EB000000E7000000EF000000DF000000BF0000007F0000000400000010000000EF000000DF000000BF0000007F0000000800000020000000F0000000F1000000F3000000F7000000EF000000DF000000BF0000007F000000070000001C000000F1000000F3000000F7000000EF000000DF000000BF0000007F0000000800000020000000F2000000F1000000F3000000F7000000EF000000DF000000BF0000007F0000000600000018000000F3000000F7000000EF000000DF000000BF0000007F0000000800000020000000F4000000F5000000F3000000F7000000EF000000DF000000BF0000007F000000070000001C000000F5000000F3000000F7000000EF000000DF000000BF0000007F0000000800000020000000F6000000F5000000F3000000F7000000EF000000DF000000BF0000007F0000000500000014000000F7000000EF000000DF000000BF0000007F0000000800000020000000F8000000F9000000FB000000F7000000EF000000DF000000BF0000007F000000070000001C000000F9000000FB000000F7000000EF000000DF000000BF0000007F0000000800000020000000FA000000F9000000FB000000F7000000EF000000DF000000BF0000007F0000000600000018000000FB000000F7000000EF000000DF000000BF0000007F0000000800000020000000FC000000FD000000FB000000F7000000EF000000DF000000BF0000007F000000070000001C000000FD000000FB000000F7000000EF000000DF000000BF0000007F";
    assert!(test_vector(
        dirpath_hex,
        0,
        size,
        FunctionType::TwoArgsPath(dirpath)
    ));
    let copath_hex = "000000080000002000000002000000050000000B000000170000002F0000005F000000BF0000017F000000070000001C000000050000000B000000170000002F0000005F000000BF0000017F000000080000002000000000000000050000000B000000170000002F0000005F000000BF0000017F00000006000000180000000B000000170000002F0000005F000000BF0000017F000000080000002000000006000000010000000B000000170000002F0000005F000000BF0000017F000000070000001C000000010000000B000000170000002F0000005F000000BF0000017F000000080000002000000004000000010000000B000000170000002F0000005F000000BF0000017F0000000500000014000000170000002F0000005F000000BF0000017F00000008000000200000000A0000000D00000003000000170000002F0000005F000000BF0000017F000000070000001C0000000D00000003000000170000002F0000005F000000BF0000017F0000000800000020000000080000000D00000003000000170000002F0000005F000000BF0000017F000000060000001800000003000000170000002F0000005F000000BF0000017F00000008000000200000000E0000000900000003000000170000002F0000005F000000BF0000017F000000070000001C0000000900000003000000170000002F0000005F000000BF0000017F00000008000000200000000C0000000900000003000000170000002F0000005F000000BF0000017F00000004000000100000002F0000005F000000BF0000017F000000080000002000000012000000150000001B000000070000002F0000005F000000BF0000017F000000070000001C000000150000001B000000070000002F0000005F000000BF0000017F000000080000002000000010000000150000001B000000070000002F0000005F000000BF0000017F00000006000000180000001B000000070000002F0000005F000000BF0000017F000000080000002000000016000000110000001B000000070000002F0000005F000000BF0000017F000000070000001C000000110000001B000000070000002F0000005F000000BF0000017F000000080000002000000014000000110000001B000000070000002F0000005F000000BF0000017F0000000500000014000000070000002F0000005F000000BF0000017F00000008000000200000001A0000001D00000013000000070000002F0000005F000000BF0000017F000000070000001C0000001D00000013000000070000002F0000005F000000BF0000017F0000000800000020000000180000001D00000013000000070000002F0000005F000000BF0000017F000000060000001800000013000000070000002F0000005F000000BF0000017F00000008000000200000001E0000001900000013000000070000002F0000005F000000BF0000017F000000070000001C0000001900000013000000070000002F0000005F000000BF0000017F00000008000000200000001C0000001900000013000000070000002F0000005F000000BF0000017F000000030000000C0000005F000000BF0000017F000000080000002000000022000000250000002B000000370000000F0000005F000000BF0000017F000000070000001C000000250000002B000000370000000F0000005F000000BF0000017F000000080000002000000020000000250000002B000000370000000F0000005F000000BF0000017F00000006000000180000002B000000370000000F0000005F000000BF0000017F000000080000002000000026000000210000002B000000370000000F0000005F000000BF0000017F000000070000001C000000210000002B000000370000000F0000005F000000BF0000017F000000080000002000000024000000210000002B000000370000000F0000005F000000BF0000017F0000000500000014000000370000000F0000005F000000BF0000017F00000008000000200000002A0000002D00000023000000370000000F0000005F000000BF0000017F000000070000001C0000002D00000023000000370000000F0000005F000000BF0000017F0000000800000020000000280000002D00000023000000370000000F0000005F000000BF0000017F000000060000001800000023000000370000000F0000005F000000BF0000017F00000008000000200000002E0000002900000023000000370000000F0000005F000000BF0000017F000000070000001C0000002900000023000000370000000F0000005F000000BF0000017F00000008000000200000002C0000002900000023000000370000000F0000005F000000BF0000017F00000004000000100000000F0000005F000000BF0000017F000000080000002000000032000000350000003B000000270000000F0000005F000000BF0000017F000000070000001C000000350000003B000000270000000F0000005F000000BF0000017F000000080000002000000030000000350000003B000000270000000F0000005F000000BF0000017F00000006000000180000003B000000270000000F0000005F000000BF0000017F000000080000002000000036000000310000003B000000270000000F0000005F000000BF0000017F000000070000001C000000310000003B000000270000000F0000005F000000BF0000017F000000080000002000000034000000310000003B000000270000000F0000005F000000BF0000017F0000000500000014000000270000000F0000005F000000BF0000017F00000008000000200000003A0000003D00000033000000270000000F0000005F000000BF0000017F000000070000001C0000003D00000033000000270000000F0000005F000000BF0000017F0000000800000020000000380000003D00000033000000270000000F0000005F000000BF0000017F000000060000001800000033000000270000000F0000005F000000BF0000017F00000008000000200000003E0000003900000033000000270000000F0000005F000000BF0000017F000000070000001C0000003900000033000000270000000F0000005F000000BF0000017F00000008000000200000003C0000003900000033000000270000000F0000005F000000BF0000017F0000000200000008000000BF0000017F000000080000002000000042000000450000004B000000570000006F0000001F000000BF0000017F000000070000001C000000450000004B000000570000006F0000001F000000BF0000017F000000080000002000000040000000450000004B000000570000006F0000001F000000BF0000017F00000006000000180000004B000000570000006F0000001F000000BF0000017F000000080000002000000046000000410000004B000000570000006F0000001F000000BF0000017F000000070000001C000000410000004B000000570000006F0000001F000000BF0000017F000000080000002000000044000000410000004B000000570000006F0000001F000000BF0000017F0000000500000014000000570000006F0000001F000000BF0000017F00000008000000200000004A0000004D00000043000000570000006F0000001F000000BF0000017F000000070000001C0000004D00000043000000570000006F0000001F000000BF0000017F0000000800000020000000480000004D00000043000000570000006F0000001F000000BF0000017F000000060000001800000043000000570000006F0000001F000000BF0000017F00000008000000200000004E0000004900000043000000570000006F0000001F000000BF0000017F000000070000001C0000004900000043000000570000006F0000001F000000BF0000017F00000008000000200000004C0000004900000043000000570000006F0000001F000000BF0000017F00000004000000100000006F0000001F000000BF0000017F000000080000002000000052000000550000005B000000470000006F0000001F000000BF0000017F000000070000001C000000550000005B000000470000006F0000001F000000BF0000017F000000080000002000000050000000550000005B000000470000006F0000001F000000BF0000017F00000006000000180000005B000000470000006F0000001F000000BF0000017F000000080000002000000056000000510000005B000000470000006F0000001F000000BF0000017F000000070000001C000000510000005B000000470000006F0000001F000000BF0000017F000000080000002000000054000000510000005B000000470000006F0000001F000000BF0000017F0000000500000014000000470000006F0000001F000000BF0000017F00000008000000200000005A0000005D00000053000000470000006F0000001F000000BF0000017F000000070000001C0000005D00000053000000470000006F0000001F000000BF0000017F0000000800000020000000580000005D00000053000000470000006F0000001F000000BF0000017F000000060000001800000053000000470000006F0000001F000000BF0000017F00000008000000200000005E0000005900000053000000470000006F0000001F000000BF0000017F000000070000001C0000005900000053000000470000006F0000001F000000BF0000017F00000008000000200000005C0000005900000053000000470000006F0000001F000000BF0000017F000000030000000C0000001F000000BF0000017F000000080000002000000062000000650000006B000000770000004F0000001F000000BF0000017F000000070000001C000000650000006B000000770000004F0000001F000000BF0000017F000000080000002000000060000000650000006B000000770000004F0000001F000000BF0000017F00000006000000180000006B000000770000004F0000001F000000BF0000017F000000080000002000000066000000610000006B000000770000004F0000001F000000BF0000017F000000070000001C000000610000006B000000770000004F0000001F000000BF0000017F000000080000002000000064000000610000006B000000770000004F0000001F000000BF0000017F0000000500000014000000770000004F0000001F000000BF0000017F00000008000000200000006A0000006D00000063000000770000004F0000001F000000BF0000017F000000070000001C0000006D00000063000000770000004F0000001F000000BF0000017F0000000800000020000000680000006D00000063000000770000004F0000001F000000BF0000017F000000060000001800000063000000770000004F0000001F000000BF0000017F00000008000000200000006E0000006900000063000000770000004F0000001F000000BF0000017F000000070000001C0000006900000063000000770000004F0000001F000000BF0000017F00000008000000200000006C0000006900000063000000770000004F0000001F000000BF0000017F00000004000000100000004F0000001F000000BF0000017F000000080000002000000072000000750000007B000000670000004F0000001F000000BF0000017F000000070000001C000000750000007B000000670000004F0000001F000000BF0000017F000000080000002000000070000000750000007B000000670000004F0000001F000000BF0000017F00000006000000180000007B000000670000004F0000001F000000BF0000017F000000080000002000000076000000710000007B000000670000004F0000001F000000BF0000017F000000070000001C000000710000007B000000670000004F0000001F000000BF0000017F000000080000002000000074000000710000007B000000670000004F0000001F000000BF0000017F0000000500000014000000670000004F0000001F000000BF0000017F00000008000000200000007A0000007D00000073000000670000004F0000001F000000BF0000017F000000070000001C0000007D00000073000000670000004F0000001F000000BF0000017F0000000800000020000000780000007D00000073000000670000004F0000001F000000BF0000017F000000060000001800000073000000670000004F0000001F000000BF0000017F00000008000000200000007E0000007900000073000000670000004F0000001F000000BF0000017F000000070000001C0000007900000073000000670000004F0000001F000000BF0000017F00000008000000200000007C0000007900000073000000670000004F0000001F000000BF0000017F00000001000000040000017F000000080000002000000082000000850000008B00000097000000AF000000DF0000003F0000017F000000070000001C000000850000008B00000097000000AF000000DF0000003F0000017F000000080000002000000080000000850000008B00000097000000AF000000DF0000003F0000017F00000006000000180000008B00000097000000AF000000DF0000003F0000017F000000080000002000000086000000810000008B00000097000000AF000000DF0000003F0000017F000000070000001C000000810000008B00000097000000AF000000DF0000003F0000017F000000080000002000000084000000810000008B00000097000000AF000000DF0000003F0000017F000000050000001400000097000000AF000000DF0000003F0000017F00000008000000200000008A0000008D0000008300000097000000AF000000DF0000003F0000017F000000070000001C0000008D0000008300000097000000AF000000DF0000003F0000017F0000000800000020000000880000008D0000008300000097000000AF000000DF0000003F0000017F00000006000000180000008300000097000000AF000000DF0000003F0000017F00000008000000200000008E000000890000008300000097000000AF000000DF0000003F0000017F000000070000001C000000890000008300000097000000AF000000DF0000003F0000017F00000008000000200000008C000000890000008300000097000000AF000000DF0000003F0000017F0000000400000010000000AF000000DF0000003F0000017F000000080000002000000092000000950000009B00000087000000AF000000DF0000003F0000017F000000070000001C000000950000009B00000087000000AF000000DF0000003F0000017F000000080000002000000090000000950000009B00000087000000AF000000DF0000003F0000017F00000006000000180000009B00000087000000AF000000DF0000003F0000017F000000080000002000000096000000910000009B00000087000000AF000000DF0000003F0000017F000000070000001C000000910000009B00000087000000AF000000DF0000003F0000017F000000080000002000000094000000910000009B00000087000000AF000000DF0000003F0000017F000000050000001400000087000000AF000000DF0000003F0000017F00000008000000200000009A0000009D0000009300000087000000AF000000DF0000003F0000017F000000070000001C0000009D0000009300000087000000AF000000DF0000003F0000017F0000000800000020000000980000009D0000009300000087000000AF000000DF0000003F0000017F00000006000000180000009300000087000000AF000000DF0000003F0000017F00000008000000200000009E000000990000009300000087000000AF000000DF0000003F0000017F000000070000001C000000990000009300000087000000AF000000DF0000003F0000017F00000008000000200000009C000000990000009300000087000000AF000000DF0000003F0000017F000000030000000C000000DF0000003F0000017F0000000800000020000000A2000000A5000000AB000000B70000008F000000DF0000003F0000017F000000070000001C000000A5000000AB000000B70000008F000000DF0000003F0000017F0000000800000020000000A0000000A5000000AB000000B70000008F000000DF0000003F0000017F0000000600000018000000AB000000B70000008F000000DF0000003F0000017F0000000800000020000000A6000000A1000000AB000000B70000008F000000DF0000003F0000017F000000070000001C000000A1000000AB000000B70000008F000000DF0000003F0000017F0000000800000020000000A4000000A1000000AB000000B70000008F000000DF0000003F0000017F0000000500000014000000B70000008F000000DF0000003F0000017F0000000800000020000000AA000000AD000000A3000000B70000008F000000DF0000003F0000017F000000070000001C000000AD000000A3000000B70000008F000000DF0000003F0000017F0000000800000020000000A8000000AD000000A3000000B70000008F000000DF0000003F0000017F0000000600000018000000A3000000B70000008F000000DF0000003F0000017F0000000800000020000000AE000000A9000000A3000000B70000008F000000DF0000003F0000017F000000070000001C000000A9000000A3000000B70000008F000000DF0000003F0000017F0000000800000020000000AC000000A9000000A3000000B70000008F000000DF0000003F0000017F00000004000000100000008F000000DF0000003F0000017F0000000800000020000000B2000000B5000000BB000000A70000008F000000DF0000003F0000017F000000070000001C000000B5000000BB000000A70000008F000000DF0000003F0000017F0000000800000020000000B0000000B5000000BB000000A70000008F000000DF0000003F0000017F0000000600000018000000BB000000A70000008F000000DF0000003F0000017F0000000800000020000000B6000000B1000000BB000000A70000008F000000DF0000003F0000017F000000070000001C000000B1000000BB000000A70000008F000000DF0000003F0000017F0000000800000020000000B4000000B1000000BB000000A70000008F000000DF0000003F0000017F0000000500000014000000A70000008F000000DF0000003F0000017F0000000800000020000000BA000000BD000000B3000000A70000008F000000DF0000003F0000017F000000070000001C000000BD000000B3000000A70000008F000000DF0000003F0000017F0000000800000020000000B8000000BD000000B3000000A70000008F000000DF0000003F0000017F0000000600000018000000B3000000A70000008F000000DF0000003F0000017F0000000800000020000000BE000000B9000000B3000000A70000008F000000DF0000003F0000017F000000070000001C000000B9000000B3000000A70000008F000000DF0000003F0000017F0000000800000020000000BC000000B9000000B3000000A70000008F000000DF0000003F0000017F00000002000000080000003F0000017F0000000800000020000000C2000000C5000000CB000000D7000000EF0000009F0000003F0000017F000000070000001C000000C5000000CB000000D7000000EF0000009F0000003F0000017F0000000800000020000000C0000000C5000000CB000000D7000000EF0000009F0000003F0000017F0000000600000018000000CB000000D7000000EF0000009F0000003F0000017F0000000800000020000000C6000000C1000000CB000000D7000000EF0000009F0000003F0000017F000000070000001C000000C1000000CB000000D7000000EF0000009F0000003F0000017F0000000800000020000000C4000000C1000000CB000000D7000000EF0000009F0000003F0000017F0000000500000014000000D7000000EF0000009F0000003F0000017F0000000800000020000000CA000000CD000000C3000000D7000000EF0000009F0000003F0000017F000000070000001C000000CD000000C3000000D7000000EF0000009F0000003F0000017F0000000800000020000000C8000000CD000000C3000000D7000000EF0000009F0000003F0000017F0000000600000018000000C3000000D7000000EF0000009F0000003F0000017F0000000800000020000000CE000000C9000000C3000000D7000000EF0000009F0000003F0000017F000000070000001C000000C9000000C3000000D7000000EF0000009F0000003F0000017F0000000800000020000000CC000000C9000000C3000000D7000000EF0000009F0000003F0000017F0000000400000010000000EF0000009F0000003F0000017F0000000800000020000000D2000000D5000000DB000000C7000000EF0000009F0000003F0000017F000000070000001C000000D5000000DB000000C7000000EF0000009F0000003F0000017F0000000800000020000000D0000000D5000000DB000000C7000000EF0000009F0000003F0000017F0000000600000018000000DB000000C7000000EF0000009F0000003F0000017F0000000800000020000000D6000000D1000000DB000000C7000000EF0000009F0000003F0000017F000000070000001C000000D1000000DB000000C7000000EF0000009F0000003F0000017F0000000800000020000000D4000000D1000000DB000000C7000000EF0000009F0000003F0000017F0000000500000014000000C7000000EF0000009F0000003F0000017F0000000800000020000000DA000000DD000000D3000000C7000000EF0000009F0000003F0000017F000000070000001C000000DD000000D3000000C7000000EF0000009F0000003F0000017F0000000800000020000000D8000000DD000000D3000000C7000000EF0000009F0000003F0000017F0000000600000018000000D3000000C7000000EF0000009F0000003F0000017F0000000800000020000000DE000000D9000000D3000000C7000000EF0000009F0000003F0000017F000000070000001C000000D9000000D3000000C7000000EF0000009F0000003F0000017F0000000800000020000000DC000000D9000000D3000000C7000000EF0000009F0000003F0000017F000000030000000C0000009F0000003F0000017F0000000800000020000000E2000000E5000000EB000000F7000000CF0000009F0000003F0000017F000000070000001C000000E5000000EB000000F7000000CF0000009F0000003F0000017F0000000800000020000000E0000000E5000000EB000000F7000000CF0000009F0000003F0000017F0000000600000018000000EB000000F7000000CF0000009F0000003F0000017F0000000800000020000000E6000000E1000000EB000000F7000000CF0000009F0000003F0000017F000000070000001C000000E1000000EB000000F7000000CF0000009F0000003F0000017F0000000800000020000000E4000000E1000000EB000000F7000000CF0000009F0000003F0000017F0000000500000014000000F7000000CF0000009F0000003F0000017F0000000800000020000000EA000000ED000000E3000000F7000000CF0000009F0000003F0000017F000000070000001C000000ED000000E3000000F7000000CF0000009F0000003F0000017F0000000800000020000000E8000000ED000000E3000000F7000000CF0000009F0000003F0000017F0000000600000018000000E3000000F7000000CF0000009F0000003F0000017F0000000800000020000000EE000000E9000000E3000000F7000000CF0000009F0000003F0000017F000000070000001C000000E9000000E3000000F7000000CF0000009F0000003F0000017F0000000800000020000000EC000000E9000000E3000000F7000000CF0000009F0000003F0000017F0000000400000010000000CF0000009F0000003F0000017F0000000800000020000000F2000000F5000000FB000000E7000000CF0000009F0000003F0000017F000000070000001C000000F5000000FB000000E7000000CF0000009F0000003F0000017F0000000800000020000000F0000000F5000000FB000000E7000000CF0000009F0000003F0000017F0000000600000018000000FB000000E7000000CF0000009F0000003F0000017F0000000800000020000000F6000000F1000000FB000000E7000000CF0000009F0000003F0000017F000000070000001C000000F1000000FB000000E7000000CF0000009F0000003F0000017F0000000800000020000000F4000000F1000000FB000000E7000000CF0000009F0000003F0000017F0000000500000014000000E7000000CF0000009F0000003F0000017F0000000800000020000000FA000000FD000000F3000000E7000000CF0000009F0000003F0000017F000000070000001C000000FD000000F3000000E7000000CF0000009F0000003F0000017F0000000800000020000000F8000000FD000000F3000000E7000000CF0000009F0000003F0000017F0000000600000018000000F3000000E7000000CF0000009F0000003F0000017F0000000800000020000000FE000000F9000000F3000000E7000000CF0000009F0000003F0000017F000000070000001C000000F9000000F3000000E7000000CF0000009F0000003F0000017F";
    assert!(test_vector(
        copath_hex,
        0,
        size,
        FunctionType::TwoArgsPath(copath)
    ));
}
